<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Frugal Innovation | Quiz</title>
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<link href='http://fonts.googleapis.com/css?family=Lato:300|Economica:400,700' rel='stylesheet' type='text/css'>
	<script src="frugalInnovationQuiz.js"></script>
	<script src="sports.js"></script>
	<script src="geography.js"></script>
	<script>
	//Global scope:
	var subjectMatterArray = ["Frugal Innovation", "Sports", "Geography"];
	var currentQuizNumber;
	var numberOfQuizzesDone = 0;
	var quizIndex = 0;

	var timeLimit = 85/*seconds*/;
	var time = timeLimit;
	var timer = function(){
		if(time <= 10 && time > 0)
		{
			var min = Math.floor((time / 60));
			var secTens = (Math.floor((time % 60) / 10)).toString();
			var sec = (Math.floor((time % 60) % 10)).toString();
			$("#timer").html('<h2>' + min + ':' + secTens + sec + '</h2>')
					  .animate({fontSize:'2em'})
					  .animate({fontSize:'1em'});
			time--;
			ctimer = setTimeout(timer, 1000);
		}
		else if (time > 0){
			var min = Math.floor((time / 60));
			var secTens = (Math.floor((time % 60) / 10)).toString();
			var sec = (Math.floor((time % 60) % 10)).toString();
			$("#timer").html('<h2>' + min + ':' + secTens + sec + '</h2>'); /***********************Change where the timer appends to************************/
			time--;
			ctimer = setTimeout(timer, 1000); //calls the first parameter after second parameter amount of time has elapsed. 
		}
		else //if the time has run out
		{
			$("#timer").html('<h2>0:00</h2>');
			time = timeLimit;
			stop();
		}
	};

	var changeLogo = function(){
					var imgFileName;
					var subject = subjectMatterArray[currentQuizNumber];
					if(subject == "Frugal Innovation")
					{
						return;
					}
					else if(subject == "Sports")
					{
						imgFileName = "basketball.png";
					}
					else
					{
						imgFileName = "globe.png";
					}
					$("#logo").attr("src", imgFileName);
					$("#logo").animate({fontSize:'2em'});
					$("#logo").animate({fontSize:'1em'});
	};
				
	
	var date = function(){
		var d = new Date();
		$("#date").empty().html("<h3>" + d.toDateString() +"</h3>");
	};
		
	function randomSubjectMatter(){
		//Generate random number 0, 1, or 2. Check global subject array and pull that one.
		if(numberOfQuizzesDone == subjectMatterArray.length)
		{
			$("#quiz").empty();
			$("#quiz").append('<h1 id="thankYou" class="center"> We are all out of quizzes for you! Refresh your page to do them again, or come back later! </h1>');
			return null;
		}

		var i;
		for(i = 0; i < 3; i++)
		{
			var x = Math.floor(Math.random() * (3)); //3 is max, excluded. 
			if(x != currentQuizNumber)
			{
				//We never want to give the same quiz twice in one sitting.
				currentQuizNumber = x;
				numberOfQuizzesDone++;
				return subjectMatterArray[x];
			}
			
		}
	};

	function shuffle(array){
		//use function to shuffle array of questions and therefore you can just iterate through them as usual while randomizing choices.
		var shuffledArray = [];
		var length = array.length;
		while(shuffledArray.length < length)
		{
			var random = Math.floor((Math.random() * array.length));
			shuffledArray.push(array.splice(random, 1)[0]);		//array.splice returns an array
		}
		return shuffledArray;
	};	

	
	function initializeQuestions(questionsName){
		//Takes the subject name as a parameter.
		//Pull the questions file assosciated with that subject name, put all the objects in an array, shuffle. 
		//return array. 
		var objectArray; 

		if(questionsName == "Frugal Innovation"){
			var length = frugalInnovationQuiz.length; //has global scope
			objectArray = frugalInnovationQuiz;
		}
		else if(questionsName == "Sports"){
			var length = sports.length;
			objectArray = sports;

		}
		else{
			//Geo case
			var length = geography.length;
			objectArray = geography;
		}
		
		objectArray = shuffle(objectArray); //Shuffles frugal innovation lab question objects. 
		
		return objectArray;
	}

	function buildQuestionAndPlaceInDocument(questionObject){

		var question = questionObject.question;
		$("#quiz").append("<h3>" + question +"</h3>");
	}


	var stop = function(){
		time = 0;
		$("#quizQuestion").empty().append('<h4 id="thanks" class="center"> Thanks for doing the quiz! </h4>');
			
	};

	function createRadio(questionObject){
		var choiceStringArray = questionObject.choices;
		for(var i=0; i < choiceStringArray.length; i++)
		{
			var choiceString = choiceStringArray[i];
			var radioBtn = $('<input type="radio" name="rbtnCount"' + choiceString + '/>');
			alert("choice string = " + choiceString);
			radioBtn.appendTo('#quizName');

		}
		
	};

	$(document).ready(function(){
		//choose a random subject matter to quiz
		//display subject in the title section
		date();
		$("#beginQuiz").click(function(){
			$("#scoreboard").html();
			$("#scoreboard").html();
			$("#scoreboard").html();
		
			$("#buttons").append('<a href="#"><div id="stop" class="button">stop</div></a>');
			$("#stop").click(function(){
				//register. 
				//Stop could mean stop this quiz particularly, or stop in general. 
				stop();
				return false;
			});

			$("#buttons").append('<a href="#"><div id ="next" class="button">next</div></a>');
			var subjectMatter = randomSubjectMatter();
			alert(subjectMatter);
			var array = initializeQuestions(subjectMatter);
			alert(array);

			changeLogo();
			$("#quizName").animate({fontSize:'2em'});
			$("#beginQuiz").remove();
			$("#quizName").empty().append("<h3>" + subjectMatter +"</h3>");
			$("#quizQuestion").append(array[0].question);
			createRadio(array[0]);
			$("#next").click(function(){
				quizIndex++;
				alert(array[quizIndex].question);
				alert("we up in here");
				$("#quizQuestion").empty().append(array[quizIndex].question);
				createRadio(array[quizIndex]);
			});
			timer();
			
			return false;
		});

	});	
	

	</script>


	<style>
		html
		{
			font-family: 'Lato', sans-serif;	
		}
		body
		{
			padding:0 5%;
			position:relative;
		}
		html, body
		{
			height:100%;
		}
		h1, h5
		{
			font-family: 'Economica', sans-serif;
		}
		.center
		{
			text-align:center;
		}

		#beginQuiz
		{
			display:inline-block;
			padding:2% 1%;
			text-align:center;
			width:30%;
			margin:0 auto;
			border: 1px solid rgba(0, 0, 0, 0.25);
		}
		.button
		{
			display:inline-block;
			padding:1% 1%;
			font-size: .75em;
			text-align:center;
			width:3%;
			margin:2% 0.5%;
			border: 1px solid rgba(0, 0, 0, 0.25);
		}
		.center a
		{
			text-decoration:none;
			color:black;
		}
		#banner
		{
			display:inline-block;
			margin-left:0.75%;
		}
		#bannerImg
		{
			display:block;
			margin:5% auto;
			width:75%;
		}

		#banner h5, h6
		{
			margin-top:-20px;
		}

		#quiz
		{
			overflow:auto;
			padding-bottom:20%;
		}
		#footer
		{
			position:relative;
			height:10%;
			margin-top:-10%;
		}
		#footer a
		{
			text-decoration:none;
			color:#6699FF;
		}
		#scoreboard
		{

		}
		#date
		{
			padding-top:2%;
			float:right;
		}
		#logo
		{
			display:inline;
			height:5em;
		}
	</style>
</head>
<body>
	<img src="SCUSeal.png" alt="SCU's Seal" id="logo"/>
	<div id="date"></div>
	<div id="banner"</div>
		
		<h1>Frugal Innovation Lab</h1>
		<h5>Innovation • Technology • Entreprenuership</h5>
		<h6>&nbsp;</h6>

	</div>
	<img src="http://upload.wikimedia.org/wikipedia/commons/c/c2/SCU_Mission_and_Palm_Trees.jpg" alt="SCU Palm Drive" id="bannerImg">
	<div class="center"><a href="#"><div id="beginQuiz">Take a Quiz</div></a></div>
	<div id="quiz"> 
		<div id="scoreboard" class="center">
			<div id="quizName" class="center"></div>
			<div id="correct"></div>
			<div id="incorrect"></div>
		</div>
		<div id="quizQuestion" class="center"></div>
		<div id="buttons" class="center">
		</div>
		<div id="timer" class="center"></div>
	</div>
	<div id="footer">
		<hr/>
		<h5>Created by <a href="https://github.com/aditprab">Adithya Prabhakaran</a> &amp; <a href="https://github.com/ntlam">Nathan Lam</a> aka Rollpt2</h5>
	</div>
</body>
</html>